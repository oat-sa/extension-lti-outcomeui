(function(){'use strict';var loaderScript=document.getElementById("amd-loader"),configUrl=loaderScript.getAttribute("data-config"),bundle=loaderScript.getAttribute("data-bundle"),loadController=function(){var controllerOptions={},controllerPath=loaderScript.getAttribute("data-controller"),params=loaderScript.getAttribute("data-params");try{controllerOptions=JSON.parse(params)}catch(err){controllerOptions={}}window.require([controllerPath],function(controller){var startController=function(){window.started||(window.started=!0,controller.start(controllerOptions))};document.addEventListener("readystatechange",startController,!1),"complete"===document.readyState&&startController()})};window.require([configUrl],function(){window.loadBundles||(window.loaded={},window.loadBundles=function(bundles){bundles=bundles||[],bundles=bundles.concat(window.bundles),bundles=bundles.filter(function(item,index){return item&&bundles.indexOf(item)===index&&!0!==window.loaded[item]}),require(bundles,function(){bundles.forEach(function(item){window.loaded[item]=!0}),loadController()})}),bundle||window.bundles&&window.bundles.length?window.loadBundles([bundle]):loadController()})})(),define("loader/bootstrap",function(){}),define("ltiOutcomeUi/controller/ItemResultPreviewer/itemResultPreviewer",["module","util/url","core/logger","core/request","taoItems/previewer/factory"],function(module,urlHelper,loggerFactory,request,previewerFactory){'use strict';function requestFileContent(variableUri,deliveryUri){return request({url:dataUrl,method:"POST",data:{variableUri:variableUri,deliveryUri:deliveryUri}}).then(function(response){var data=response.data,name=response.name,mime=response.mime;return{data:data,name:name,mime:mime}})}function refineFileResponse(response,deliveryUri){var file=response&&response.base&&response.base.file;return file&&file.uri&&!file.data?requestFileContent(file.uri,deliveryUri).then(function(fileData){fileData&&fileData.data?response.base.file=fileData:response.base=null}).catch(function(e){return logger.error(e)}):Promise.resolve()}function refineItemState(state,deliveryUri){if(!state)return Promise.resolve(state);var filePromises=Object.keys(state).map(function(identifier){var response=state[identifier].response;return refineFileResponse(response,deliveryUri)});return Promise.all(filePromises).then(function(){return state})}var logger=loggerFactory("ltiOutcomeUi/ItemResultPreviewer"),dataUrl=urlHelper.route("getVariableFile","ItemResultPreviewer","ltiOutcomeUi"),plugins=[{module:"ltiOutcomeUi/previewer/plugins/content/scoringHighlighter",bundle:"ltiOutcomeUi/loader/ltiOutcomeUi.min",category:"content"}];return{start:function start(config){var uri=config.uri,resultIdentifier=config.resultIdentifier,itemDefinition=config.itemDefinition,deliveryUri=config.deliveryIdentifier,uri={uri:uri,resultId:resultIdentifier,itemDefinition:itemDefinition,deliveryUri:deliveryUri},type=config.type;refineItemState(config.state,deliveryUri).then(function(state){previewerFactory(type,uri,state,{view:"scorer",fullPage:!0,hideActionBars:!0,plugins:plugins})})}}}),define("ltiOutcomeUi/controller/routes",{ItemResultPreviewer:{actions:{preview:"controller/ItemResultPreviewer/itemResultPreviewer"}}}),define("ltiOutcomeUi/loader/ltiOutcomeUi.bundle",function(){}),window.bundles=(window.bundles||[]).concat(["taoItems/loader/taoItems.min"]);
//# sourceMappingURL=ltiOutcomeUi.min.js.map